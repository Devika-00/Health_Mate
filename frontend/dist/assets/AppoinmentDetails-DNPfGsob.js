import{q as H,b as J,u as L,r as a,z as D,t as Q,j as e,U as m,C as X}from"./index-FVufT_0B.js";import{N as Y}from"./navbar-B0eQFEER.js";import{a as u}from"./axiosService-ipmmkjpt.js";import{s as x}from"./toaster-k-cUy_PL.js";import{d as ee,e as se,f as te,g as ne,h as oe}from"./index-Byd_-nD1.js";import{b as ae}from"./uploadImages-DZOBWZvz.js";import{a as le}from"./index-BGCpuYXh.js";import{F as re}from"./index-jBFMkMfL.js";import{a as ie}from"./axios-Cm0UX6qg.js";import"./index-VWaDGczM.js";import"./iconBase-Fa8OabD3.js";const ve=()=>{var v;const h=H(s=>s.UserSlice),{id:l}=J(),p=L(),[o,j]=a.useState(null),[r,C]=a.useState(null),[k,f]=a.useState(!1),[S,N]=a.useState(!1),[P,b]=a.useState(!1),[g,y]=a.useState(null),[w,A]=a.useState(""),[c,d]=a.useState([{name:"",documentFile:null}]),F=h.id,I=h.name,T=D.ZegoUIKitPrebuilt.generateKitTokenForTest(1631866234,"ef643f6bf95ef4488775c1cd2d944227",null,F,I);D.ZegoUIKitPrebuilt.create(T).addPlugins({ZIM:Q.ZIM}),a.useEffect(()=>{(async()=>{try{const n=(await u.get(`${m}/bookingdetails/${l}`)).data.data.bookingDetails;j(n);const i=await u.get(`${m}/doctor/${n.doctorId}`);C(i.data.doctor)}catch(t){console.error("Error fetching booking details:",t)}})()},[l]);const E=async()=>{try{await u.put(`${m}/bookingdetails/${l}`,{appoinmentStatus:"Cancelled",cancelReason:w}),j(s=>({...s,appoinmentStatus:"Cancelled"})),x("Appoinment Cancelled","success"),f(!1)}catch(s){console.error("Error cancelling appointment:",s)}},M=()=>{o.consultationType==="Online"?p(`/user/appoinmentOnline/${o.doctorId}`):o.consultationType==="Offline"&&p(`/user/appoinmentOffline/${o.doctorId}`)},$=()=>{if(o.appoinmentStatus==="Booked")return e.jsx("button",{onClick:()=>f(!0),className:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded mt-5",children:"Cancel Appointment"});if(o.appoinmentStatus==="Cancelled")return e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-red-500",children:"Appointment Cancelled"}),e.jsx("button",{onClick:M,className:"bg-blue-800 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Reschedule Appointment"})]});if(o.appoinmentStatus==="Consulted")return e.jsx("p",{className:"text-green-500",children:"Consultation Completed"})},R=async s=>{const t={appoinmentId:s},n=await u.post(`${m}/fetchPrescription`,t);n.data&&n.data.response?(y(n.data.response),N(!0)):x("No prescription added by the doctor","error")},z=async s=>{b(!0)},U=async s=>{p(`/user/documents/${s}`)};function O(){N(!1),y(null)}function B(){b(!1)}const Z=(s,t)=>{const n=[...c];n[s].name=t,d(n)},K=(s,t)=>{const n=[...c];n[s].documentFile=t,d(n)},_=async s=>{s.preventDefault();try{const t=[];for(const i of c){const W=await ae(i.documentFile);t.push({name:i.name,url:W})}(await u.post(`${m}/uploadDocuments`,{id:l,documents:t})).data.sucess?(x("Documents uploaded successfully","success"),b(!1),d([])):x("Failed to upload documents","error")}catch(t){console.error("Error uploading documents:",t),x("Error uploading documents","error")}},q=()=>{d([...c,{name:"",documentFile:null}])},G=s=>{const t=[...c];t.splice(s,1),d(t)},V=()=>{ie.post(X+"/conversations",{senderId:h.id,recieverId:r._id}).then(({})=>{p("/user/chat")}).catch(()=>{console.log("error in sending chat")})};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Booking Details"}),o&&r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx("div",{className:"bg-blue-50 p-6 rounded-lg shadow-md border border-blue-200",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("img",{src:r.profileImage,alt:r.doctorName,className:"w-40 h-40 rounded mr-4"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:r.doctorName}),e.jsx("p",{children:r.department}),e.jsx("p",{className:"text-green-600 font-semibold",children:"Verified"}),e.jsx("div",{className:"flex",children:e.jsxs("button",{onClick:()=>V(),className:"bg-blue-800 flex hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-3",children:[e.jsx(re,{className:"mr-2 mt-1"}),"Chat"]})})]})]})}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg shadow-md border border-blue-200",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Scheduled Appointment"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Date: ",new Date(o.date).toLocaleDateString()]}),e.jsxs("p",{className:"font-medium",children:["Time: ",o.timeSlot]}),e.jsxs("p",{className:"font-medium",children:["Patient Name: ",o.patientName]}),e.jsxs("p",{className:"font-medium",children:["Patient Age: ",o.patientAge]}),e.jsxs("p",{className:"font-medium",children:["Patient Gender: ",o.patientGender]}),$()]})]}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg shadow-md border border-blue-200",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consultation Details"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Consultation Type: ",o.consultationType]}),e.jsxs("p",{className:"font-medium",children:["Payment Status: ",o.paymentStatus]}),e.jsx("h1",{className:"text-2xl font-bold mb-1 mt-4",children:"Prescription"}),e.jsx("p",{className:"mb-3 text-blue-900",children:"Click the button to see the prescription"}),e.jsxs("button",{onClick:()=>R(l),className:"bg-green-800 flex hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:[e.jsx(ee,{className:"mr-2 mt-1"}),"Check Prescription"]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg shadow-md border border-blue-200",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Documents"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-900",children:"Click the button to add the lab record documents "}),e.jsxs("p",{onClick:()=>z(),className:"text-orange-800 hover:text-orange-700 cursor-pointer underline mt-3 flex items-center font-bold text-md",children:[e.jsx(se,{className:"mr-2 mt-1"}),"Add Documents"]}),e.jsx("p",{className:"mt-3 text-blue-900",children:"Click the view documents button to see all the lab docuemnts uploaded "}),e.jsxs("p",{onClick:()=>U(l),className:"text-blue-800 hover:text-blue-700 cursor-pointer underline mt-3 flex items-center font-bold text-md",children:[e.jsx(le,{className:"mr-2 mt-1"}),"View Document"]})]})]})]}),k&&e.jsx("div",{className:"fixed top-0 left-0 flex justify-center items-center w-full h-full bg-gray-900 bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-xl transform transition-all max-w-lg w-full",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reason for Cancellation"}),e.jsx("div",{className:"mt-2",children:e.jsx("textarea",{value:w,onChange:s=>A(s.target.value),className:"block w-full p-2 sm:text-sm border-gray-300 rounded-md",rows:4,placeholder:"Enter reason for cancellation"})})]}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{onClick:E,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-500 text-base font-medium text-white hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Confirm"}),e.jsx("button",{onClick:()=>f(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})}),S&&e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-xl",children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Prescription Details"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Doctor:"})," ",r.doctorName]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Appointment ID:"}),l]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Prescription Date:"})," ",new Date(g.prescriptionDate).toDateString()]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Medicines:"}),(v=g.medicines)==null?void 0:v.map((s,t)=>e.jsx("li",{className:"text-gray-500",children:e.jsxs("span",{className:"font-semibold",children:["Name:",e.jsx("span",{className:"text-red-700",children:s.name})," - Dosage:"," ",e.jsxs("span",{className:"text-red-700",children:[s.dosage," "]}),"-Instructions :"," ",e.jsx("span",{className:"text-red-700",children:s.instructions})," "]})},t))]}),e.jsx("button",{onClick:O,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition ease-in-out duration-300",children:"Close"})]}):e.jsx("p",{className:"text-gray-700",children:"No Prescription added ..."})}),P&&e.jsx("div",{className:"fixed top-0 left-0 w-full h-full flex items-center justify-center bg-gray-900 bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Add Documents"}),e.jsx("button",{onClick:B,className:"text-gray-600 hover:text-gray-900",children:e.jsx(te,{})})]}),e.jsxs("form",{onSubmit:_,children:[c.map((s,t)=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"text",value:s.name,onChange:n=>Z(t,n.target.value),className:"block w-full p-2 sm:text-sm border-gray-300 rounded-md",placeholder:"Document Name"}),e.jsx("button",{type:"button",onClick:()=>G(t),className:"ml-2 text-red-500 hover:text-red-700",children:e.jsx(ne,{})})]}),e.jsx("input",{type:"file",onChange:n=>{var i;return K(t,(i=n.target.files)==null?void 0:i[0])},className:`block w-full text-sm text-gray-500\r
                        file:mr-4 file:py-2 file:px-4\r
                        file:rounded-md file:border-0\r
                        file:text-sm file:font-semibold\r
                        file:bg-blue-50 file:text-blue-700\r
                        hover:file:bg-blue-100`})]},t)),e.jsxs("button",{type:"button",onClick:q,className:"flex items-center mb-4 text-blue-600 hover:text-blue-800",children:[e.jsx(oe,{className:"mr-2"}),"Add Another Document"]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition ease-in-out duration-300",children:"Submit"})]})]})})]})]})};export{ve as default};
