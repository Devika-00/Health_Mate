import{r as n,D as w,n as S,p as I,j as t}from"./index-DJaU1TX-.js";import{N as P}from"./navbar-BxKSBfTU.js";import{b as k}from"./index-PUt_BT-H.js";import{a as E}from"./axiosService-DiBwSofh.js";import{s as y}from"./toaster-DBUzP4su.js";import{a as R,u as A}from"./uploadImages-BQ7Mk5YW.js";import{a as j}from"./axios-Cm0UX6qg.js";import"./iconBase-CqICZbar.js";import"./index-VWaDGczM.js";j.defaults.withCredentials=!0;const M=()=>{const[l,f]=n.useState(null),[o,s]=n.useState(null),[,g]=n.useState(!1),[a,r]=n.useState({doctorName:"",gender:"",email:"",age:null,department:"",description:"",experience:"",phoneNumber:"",education:"",status:"pending",imageFile:null,lisenceCertificate:null}),[h,v]=n.useState(null),[c,u]=n.useState(null),[C,x]=n.useState(!1);return n.useEffect(()=>{j.get(w+"/profile",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(({data:d})=>{const{doctor:e}=d;f(e),r(i=>({...i,doctorName:e==null?void 0:e.doctorName,age:e==null?void 0:e.age,gender:e==null?void 0:e.gender,department:e==null?void 0:e.department,description:e==null?void 0:e.description,education:e==null?void 0:e.education,email:e==null?void 0:e.email,phoneNumber:e==null?void 0:e.phoneNumber,experience:e==null?void 0:e.experience,lisenceCertificate:e==null?void 0:e.lisenceCertificate,status:e==null?void 0:e.status}))}).catch(()=>y("Oops! Something went wrong","error"))},[]),{profile:l,formData:a,imagePreview:h,certificatePreview:c,error:o,isSubmitting:C,handleInputChange:d=>{const{name:e,value:i}=d.target;let p="";if(e==="imageFile"||e==="lisenceCertificate"){const m=d.target,N=m.files&&m.files[0];if(N){const b=new FileReader;b.onloadend=()=>{e==="imageFile"?v(b.result):u(b.result)},b.readAsDataURL(N),r(F=>({...F,[e]:N}))}}else{if(e==="name")i.trim()?S.test(i)||(p="First letter must be capital and no leading or trailing space"):p="Name is required";else if(e==="age"){const m=parseInt(i,10);(isNaN(m)||m<0)&&(p="Age must be a positive number")}else e==="phoneNumber"&&(i.trim()?I.test(i)||(p="Phone number must have 10 numbers"):p="Phone number is required");r(m=>({...m,[e]:e==="age"?parseInt(i,10):i}))}s(p)},handleSubmit:async()=>{if(!o){x(!0);try{const d=await R(a.imageFile),e=await A(a.lisenceCertificate),i=await E.patch(w+"/profile/edit",{doctorName:a.doctorName,gender:a.gender,age:a.age,phoneNumber:a.phoneNumber,department:a.department,education:a.education,description:a.description,experience:a.experience,profileImage:d||(l==null?void 0:l.profileImage),lisenceCertificate:e||(l==null?void 0:l.lisenceCertificate)},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});y(i.data.message),x(!1)}catch{x(!1),y("Oops! Something went wrong while updating profile","error")}}},handleVerify:()=>{g(!0)}}},G=()=>{const[l,f]=n.useState([]),{profile:o,formData:s,imagePreview:g,certificatePreview:a,handleInputChange:r,handleSubmit:h}=M();return n.useEffect(()=>{(async()=>{try{const u=await j.get(`${w}/departments`);if(u.data.success)f(u.data.allDepartment);else throw new Error("Failed to fetch doctor details")}catch(u){console.error("Error fetching doctor details:",u)}})()},[]),t.jsxs(t.Fragment,{children:[t.jsx(P,{}),t.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-white",children:t.jsxs("div",{className:"flex flex-col items-center w-full md:w-3/5 lg:w-2/5 justify-center mb-10 mt-9 bg-blue-200 rounded-lg p-6 shadow-lg text-white relative",children:[t.jsxs("div",{className:"relative mb-4",children:[t.jsx("img",{src:g||((o==null?void 0:o.profileImage)??"https://picsum.photos/200/"),alt:"Profile",className:"w-32 h-32 rounded-full"}),t.jsxs("label",{htmlFor:"profile-image",className:"absolute bottom-0 right-0 bg-white text-blue-900 rounded-full cursor-pointer border-4 border-white px-2 py-1 ",children:[t.jsx("input",{type:"file",id:"profile-image",className:"hidden",accept:"image/*",name:"imageFile",onChange:r}),t.jsx(k,{})]})]}),t.jsxs("div",{className:"bg-white w-full md:w-3/4 p-6 mb-3 rounded-lg shadow-lg",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"name",className:"block text-gray-700 font-semibold",children:"Name:"}),t.jsx("input",{type:"text",id:"name",name:"doctorName",value:(s==null?void 0:s.doctorName)??"",onChange:r,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email:"}),t.jsx("input",{type:"email",id:"email",name:"email",value:(s==null?void 0:s.email)??"",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"phoneNumber",className:"block text-gray-700 font-semibold",children:"Phone Number:"}),t.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:(s==null?void 0:s.phoneNumber)??"",onChange:r,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"department",className:"block text-gray-700 font-semibold",children:"Department:"}),t.jsxs("select",{id:"department",name:"department",value:(s==null?void 0:s.department)??"",onChange:r,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500",children:[t.jsx("option",{className:"text-gray-700",value:""}),l.filter(c=>c.isListed).map(c=>t.jsx("option",{className:"text-gray-700",value:c.departmentName,children:c.departmentName},c._id))]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"description",className:"block text-gray-700 font-semibold",children:"Description:"}),t.jsx("input",{id:"description",name:"description",value:(s==null?void 0:s.description)??"",onChange:r,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"education",className:"block text-gray-700 font-semibold",children:"Education:"}),t.jsx("input",{type:"text",id:"education",name:"education",value:(s==null?void 0:s.education)??"",onChange:r,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"experience",className:"block text-gray-700 font-semibold",children:"Experience:"}),t.jsx("input",{id:"experience",name:"experience",value:(s==null?void 0:s.experience)??"",onChange:r,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"lisenceCertificate",className:"block text-gray-700 font-semibold",children:"Doctor Lisence Certificate :"}),t.jsx("input",{type:"file",id:"lisenceCertificate",name:"lisenceCertificate",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500",onChange:r}),t.jsx("img",{src:a||(o==null?void 0:o.lisenceCertificate),alt:"License Certificate Preview",className:"mt-2 w-full"})]}),t.jsx("p",{className:(s==null?void 0:s.status)==="approved"?"text-green-700 font-bold":(s==null?void 0:s.status)==="rejected"?"text-red-600 font-bold":"text-yellow-600 font-bold",children:""}),t.jsx("button",{className:"bg-blue-900 text-white py-2 px-4 mt-5 ml-5 rounded-md hover:bg-blue-800 focus:outline-none focus:ring focus:border-blue-500",onClick:h,children:"Update Profile"})]})]})})]})};export{G as default};
