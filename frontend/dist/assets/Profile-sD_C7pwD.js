import{r as d,U as p,n as y,p as F,j as e,L as P}from"./index-DvlxLBRP.js";import{N as S}from"./navbar-CHl6ZHU9.js";import{G as C}from"./iconBase-ZWK5A-To.js";import{a as I}from"./axiosService-CDsI4QPu.js";import{s as f}from"./toaster-HDMX5aEB.js";import{a as k}from"./uploadImages-B3NZLL9r.js";import{a as x}from"./axios-Cm0UX6qg.js";import{b as A}from"./index-BC0GOEqA.js";import"./index-xu6WTHlj.js";import"./index-VWaDGczM.js";function E(l){return C({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M0 3a2 2 0 0 1 2-2h13.5a.5.5 0 0 1 0 1H15v2a1 1 0 0 1 1 1v8.5a1.5 1.5 0 0 1-1.5 1.5h-12A2.5 2.5 0 0 1 0 12.5V3zm1 1.732V12.5A1.5 1.5 0 0 0 2.5 14h12a.5.5 0 0 0 .5-.5V5H2a1.99 1.99 0 0 1-1-.268zM1 3a1 1 0 0 0 1 1h12V2H2a1 1 0 0 0-1 1z"},child:[]}]})(l)}x.defaults.withCredentials=!0;const M=()=>{const[l,s]=d.useState(null),[u,t]=d.useState(null),[n,c]=d.useState({name:"",gender:"",age:null,phoneNumber:"",imageFile:null}),[N,j]=d.useState(null),[v,g]=d.useState(!1);return d.useEffect(()=>{x.get(p+"/profile",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(({data:i})=>{const{user:a}=i;s(a),c(r=>({...r,name:(a==null?void 0:a.name)||"",gender:(a==null?void 0:a.gender)||"",age:(a==null?void 0:a.age)||null,phoneNumber:(a==null?void 0:a.phoneNumber)||""}))}).catch(()=>f("Oops! Something went wrong","error"))},[]),{profile:l,formData:n,imagePreview:N,error:u,isSubmitting:v,handleInputChange:i=>{const{name:a,value:r}=i.target;let m="";if(a==="imageFile"){const o=i.target,h=o.files&&o.files[0];if(h){const b=new FileReader;b.onloadend=()=>{j(b.result)},b.readAsDataURL(h),c(w=>({...w,imageFile:h}))}}else{if(a==="name")r.trim()?y.test(r)||(m="First letter must be capital and no leading or trailing space"):m="Name is required";else if(a==="age"){const o=parseInt(r,10);(isNaN(o)||o<0)&&(m="Age must be a positive number")}else a==="phoneNumber"&&(r.trim()?F.test(r)||(m="Phone number must have 10 numbers"):m="Phone number is required");c(o=>({...o,[a]:a==="age"?parseInt(r,10):r}))}t(m)},handleSubmit:async()=>{if(!u){g(!0);const i=await k(n.imageFile);I.patch(p+"/profile/edit",{name:n.name,gender:n.gender,age:n.age,phoneNumber:n.phoneNumber,profilePicture:i||(l==null?void 0:l.profilePicture)},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(({data:a})=>{f(a.message),g(!1)}).catch(()=>{g(!1),f("Oops! Something went wrong while updating profile","error")})}}}},q=()=>{const{profile:l,formData:s,imagePreview:u,handleInputChange:t,handleSubmit:n}=M();return e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center",children:[e.jsx("h2",{className:"text-4xl font-bold mt-6 text-center text-blue-900",children:"Profile"}),e.jsxs("div",{className:"bg-blue-900 mt-10 mb-10 w-full max-w-2xl rounded-lg shadow-lg p-6 relative",children:[e.jsxs(P,{to:"/user/wallet",className:"absolute top-4 right-4 bg-blue-100 hover:bg-blue-200 text-blue-900 rounded-md p-2 flex items-center",children:[e.jsx(E,{className:"h-7 w-7"}),e.jsx("span",{className:"ml-2",children:"Wallet"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("img",{src:u||((l==null?void 0:l.profilePicture)??"https://picsum.photos/200/"),alt:"Profile",className:"w-36 h-36 rounded-full"}),e.jsxs("label",{htmlFor:"profile-image",className:"absolute bottom-0 right-0 bg-white text-blue-900 rounded-full cursor-pointer border-4 border-white p-1",children:[e.jsx("input",{type:"file",id:"profile-image",name:"imageFile",className:"hidden",onChange:t}),e.jsx(A,{})]})]}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"bg-white w-full rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-700 font-semibold",children:"Name:"}),e.jsx("input",{type:"text",id:"name",value:s.name,name:"name",onChange:t,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email:"}),e.jsx("input",{type:"email",id:"email",name:"email",value:(l==null?void 0:l.email)??"",onChange:t,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"age",className:"block text-gray-700 font-semibold",children:"Age:"}),e.jsx("input",{type:"number",id:"age",name:"age",value:(s==null?void 0:s.age)??"",onChange:t,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"phoneNumber",className:"block text-gray-700 font-semibold",children:"Phone Number:"}),e.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:(s==null?void 0:s.phoneNumber)??"",onChange:t,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"gender",className:"block text-gray-700 font-semibold",children:"Gender:"}),e.jsxs("select",{id:"gender",name:"gender",value:(s==null?void 0:s.gender)??"",onChange:t,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-blue-500",children:[e.jsx("option",{className:"text-gray-700",value:"male",children:"Male"}),e.jsx("option",{className:"text-gray-700",value:"female",children:"Female"}),e.jsx("option",{className:"text-gray-700",value:"others",children:"Others"})]})]}),e.jsx("button",{className:"bg-blue-900 text-white py-2 px-4 mt-3 w-full rounded-md hover:bg-blue-800 focus:outline-none focus:ring focus:border-blue-500",onClick:n,children:"Update Profile"})]})})]})]})]})]})};export{q as default};
