import{a as s}from"./axios-Cm0UX6qg.js";import{j as i}from"./index-VWaDGczM.js";import{B as l,y as u,T as d}from"./index-BwAjAq79.js";import{s as h}from"./toaster-CIcOBpXB.js";const k=(e,o="success")=>{l.dispatch(u()),h(e,o)},a=s.create();a.defaults.withCredentials=!0;const g=async()=>{try{const e=localStorage.getItem("access_token");if(!e)return console.error("Access token not found in local storage"),null;const o={Authorization:`Bearer ${e}`},{data:n}=await s.get(`${d}/accessToken`,{headers:o}),c=await i(e),{role:r}=c;if(r==="doctor"||r==="user"){const{user:t}=n;if(t&&t.isBlocked)return k("Your account has been blocked by the administrator","error"),null}return e}catch(e){return console.log(e,"Error in getting token"),null}};a.interceptors.request.use(async e=>{try{const o=await g();o&&(e.headers.Authorization=`Bearer ${o}`)}catch(o){console.log("Error in adding token to request:",o)}return e});export{a};
