import{r as l,j as e,A as d}from"./index-CRT0yd8N.js";import{A as k}from"./Header-Cbj6sYE_.js";import{A as C}from"./Sidebar-C8_FTDow.js";import{h as A,i as S}from"./index-pW0aNAUB.js";import{a as m}from"./axiosService-pwabPVeH.js";import{s as r}from"./toaster-DRgQ7L49.js";import"./iconBase-yuOEJls_.js";import"./axios-Cm0UX6qg.js";import"./index-VWaDGczM.js";const L=()=>{const[x,c]=l.useState([]),[f,N]=l.useState(!1),[n,i]=l.useState(""),[p,u]=l.useState(null),[h,b]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const t=await m.get(`${d}/departments`);c(t.data.allDepartment)}catch(t){console.error("Error fetching departments:",t)}})()},[]);const y=async s=>{c(t=>t.map(a=>a._id===s?{...a,isListed:!a.isListed}:a));try{const t=await m.patch(`${d}/unlist_department/${s}`);t.data.success&&r(t.data.message,"success")}catch(t){console.log(t)}},o=()=>{N(!f)},w=s=>{i(s.target.value)},j=s=>x.some(t=>t.departmentName.toLowerCase()===s.toLowerCase()),D=async()=>{if(j(n)){r("Department already exists","error");return}const s={_id:(x.length+1).toString(),departmentName:n,isListed:!0};try{const t=await m.post(`${d}/addDepartment`,s);t.data.success&&(r(t.data.message,"success"),c(a=>[...a,s]),i(""),o())}catch(t){console.error("Error adding department:",t),r("There was an error adding the department.","error")}},v=async()=>{if(!p)return;if(j(n)){r("Department already exists","error");return}const s={departmentName:n};try{const t=await m.put(`${d}/departments/${p}`,s);t.data.success&&(r(t.data.message,"success"),c(a=>a.map(g=>g._id===p?{...g,departmentName:n}:g)),i(""),u(null),o())}catch(t){console.error("Error editing department:",t),r("There was an error editing the department.","error")}},E=s=>{i(s.departmentName),u(s._id),b(!0),o()};return e.jsxs("div",{className:"p-6 bg-gray-100 min-h-screen",children:[e.jsx("div",{className:"flex justify-end ",children:e.jsxs("button",{onClick:()=>{i(""),u(null),b(!1),o()},className:"flex items-center px-4 py-2 bg-blue-950 text-white rounded-md hover:bg-blue-800 focus:outline-none focus:bg-blue-800",children:[e.jsx(A,{className:"mr-2"}),"Add More"]})}),e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Department Management"}),e.jsx("div",{className:"overflow-x-auto shadow-lg rounded-lg",children:e.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-gradient-to-r from-blue-950 to-indigo-500 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Serial No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Department Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"list & unlisted"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Edit"})]})}),e.jsx("tbody",{className:"bg-white",children:x.map((s,t)=>e.jsxs("tr",{className:"border-b last:border-none hover:bg-gray-100 transition",children:[e.jsx("td",{className:"px-6 py-4 text-left font-medium text-gray-900 whitespace-nowrap",children:t+1}),e.jsx("td",{className:"px-6 py-4 text-left text-gray-700",children:s.departmentName}),e.jsx("td",{className:"px-6 py-4 text-left",children:e.jsx("label",{className:"flex cursor-pointer select-none items-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:s.isListed,onChange:()=>y(s._id),className:"sr-only"}),e.jsx("div",{className:`box block h-6 w-10 rounded-full ${s.isListed?"bg-green-500":"bg-red-500"}`}),e.jsx("div",{className:`absolute left-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-white transition ${s.isListed?"translate-x-full":""}`})]})})}),e.jsx("td",{className:"px-6 py-4 text-left",children:e.jsx(S,{className:"text-blue-500 cursor-pointer",onClick:()=>E(s)})})]},s._id))})]})}),f&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("h2",{className:"text-lg font-bold mb-4 text-center",children:h?"Edit Department":"Add Department"}),e.jsx("input",{type:"text",value:n,onChange:w,placeholder:"Enter Department Name",className:"w-full border border-gray-300 rounded-md px-4 py-3 mb-4 text-lg"}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:h?v:D,className:"px-4 py-2 mt-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:bg-blue-600",children:h?"Edit":"Add"}),e.jsx("button",{onClick:o,className:"px-4 py-2 ml-2 mt-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 focus:outline-none focus:bg-gray-400",children:"Cancel"})]})]})})]})},R=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex h-screen",children:[e.jsx(C,{}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx(k,{}),e.jsx("div",{className:"p-6",children:e.jsx(L,{})})]})]})});export{R as default};
