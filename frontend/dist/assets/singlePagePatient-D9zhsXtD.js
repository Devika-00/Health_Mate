import{b as z,q as K,u as _,r as l,z as p,t as G,j as e,D as u,U as q,C as B}from"./index-Dy8_-3mV.js";import{N as J}from"./navbar-C4_LknCt.js";import{a as x}from"./axiosService-CL6nNHCo.js";import{G as W}from"./iconBase-DyBkyMOM.js";import{s as b}from"./toaster-D5eNlOP_.js";import{A as Q,a as w}from"./index-Dzp1MTOC.js";import{F as X}from"./index-Cln0hlj2.js";import{a as Y}from"./axios-Cm0UX6qg.js";import"./index-VWaDGczM.js";function ee(i){return W({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M15 4H5V20H19V8H15V4ZM3 2.9918C3 2.44405 3.44749 2 3.9985 2H16L20.9997 7L21 20.9925C21 21.5489 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5447 3 21.0082V2.9918ZM11 11V8H13V11H16V13H13V16H11V13H8V11H11Z"},child:[]}]})(i)}const se=()=>{var v;const{id:i}=z(),m=K(s=>s.DoctorSlice),j=_(),[n,C]=l.useState(null),[P,D]=l.useState(!0),[S,g]=l.useState(!1),[N,I]=l.useState(new Date().toISOString().split("T")[0]),[k,M]=l.useState(""),[V,h]=l.useState(!1),[o,d]=l.useState([{name:"",dosage:"",instructions:""}]),[c,f]=l.useState(null),A=m.id,T=m.name,H=p.ZegoUIKitPrebuilt.generateKitTokenForTest(1631866234,"ef643f6bf95ef4488775c1cd2d944227",null,A,T),y=p.ZegoUIKitPrebuilt.create(H);y.addPlugins({ZIM:G.ZIM});function E(){const s={userID:n.userId,userName:n.patientName};y.sendCallInvitation({callees:[s],callType:p.ZegoUIKitPrebuilt.InvitationTypeVideoCall,timeout:60}).then(a=>{console.warn(a)}).catch(a=>{console.warn(a)})}l.useEffect(()=>{const s=async()=>{try{const r=(await x.get(`${q}/bookingdetails/${i}`)).data.data.bookingDetails;C(r)}catch(t){console.error("Error fetching patient details:",t)}finally{D(!1)}},a=async()=>{try{const t=await x.get(`${u}/prescription/${i}`);t.data.response&&t.data.response.length>0&&f(t.data.response[0])}catch(t){console.error("Error fetching prescription details:",t)}};s(),a()},[i]);const O=()=>{g(!0)},Z=()=>{h(!0)},F=()=>{g(!1)},$=s=>{j(`/user/documents/${s}`)},L=async()=>{const s={appointmentId:i,prescriptionDate:N,medicines:o};await x.post(`${u}/addPrescription`,s)&&b("Prescription added successfully","success"),g(!1)};if(P)return e.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:e.jsx("p",{className:"text-xl font-semibold",children:"Loading..."})});const R=()=>{Y.post(B+"/conversations",{senderId:n.userId,recieverId:m.id}).then(({data:s})=>{console.log(s,"dataaaaaaaa"),j("/doctor/chat")}).catch(()=>{console.log("error in sending chat")})};return e.jsxs("div",{className:"flex justify-center items-center py-10 bg-gray-100",children:[e.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Patient Details"}),n?e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:n.patientName})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Age"}),e.jsx("p",{className:"text-gray-900",children:n.patientAge})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Gender"}),e.jsx("p",{className:"text-gray-900",children:n.patientGender})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Consultation Type"}),e.jsx("p",{className:"text-gray-900",children:n.consultationType})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(n.date).toLocaleDateString()})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Time"}),e.jsx("p",{className:"text-gray-900",children:n.timeSlot})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Amount"}),e.jsx("p",{className:"text-gray-900",children:n.fee})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Payment Status"}),e.jsx("p",{className:"text-gray-900",children:n.paymentStatus})]}),n.appoinmentStatus==="Booked"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Chat with Patient"}),e.jsxs("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-md shadow hover:bg-blue-800 flex items-center mt-3",onClick:R,children:[e.jsx(X,{className:"mr-2"})," Chat"]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Join the Call"}),e.jsxs("button",{className:"bg-green-500 text-white py-2 px-4 rounded-md shadow hover:bg-green-800 flex items-center mt-3",onClick:E,children:[e.jsx(Q,{className:"mr-2"})," Video Call"]})]}),e.jsxs("div",{className:"flex justify-center items-center mt-4 md:col-span-2",children:[c?e.jsxs("button",{className:"bg-blue-900 text-white py-2 px-4 rounded-md shadow hover:bg-blue-800 flex items-center",onClick:Z,children:[e.jsx(w,{className:"mr-2"})," View Prescription"]}):e.jsxs("button",{className:"bg-blue-900 text-white py-2 px-4 rounded-md shadow hover:bg-blue-800 flex items-center",onClick:O,children:[e.jsx(ee,{className:"mr-2"})," Add Prescription"]}),e.jsxs("button",{className:"bg-blue-900 text-white py-2 px-4 rounded-md shadow hover:bg-blue-800 flex items-center ml-5",onClick:()=>$(i),children:[e.jsx(w,{className:"mr-2"})," View Medical Documents"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-red-500 text-md font-bold ",children:"Appointment cancelled"}),e.jsxs("p",{className:"text-red-500 text-md font-bold ",children:["Reason: ",n.appoinmentCancelReason]})]})]}):e.jsx("p",{className:"text-center text-gray-700 ",children:"No patient details available."})]}),S&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Add Prescription"}),e.jsxs("div",{className:"mt-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prescription Date"}),e.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full focus:outline-none focus:border-blue-800",value:N,onChange:s=>I(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Doctor's Name"}),e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full focus:outline-none focus:border-blue-800",value:k,onChange:s=>M(s.target.value)})]}),o.map((s,a)=>e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full",placeholder:"Medicine Name",value:s.name,onChange:t=>{const r=[...o];r[a].name=t.target.value,d(r)}}),e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full",placeholder:"Dosage",value:s.dosage,onChange:t=>{const r=[...o];r[a].dosage=t.target.value,d(r)}}),e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full",placeholder:"Instructions",value:s.instructions,onChange:t=>{const r=[...o];r[a].instructions=t.target.value,d(r)}}),a>0&&e.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:()=>{const t=o.filter((r,U)=>U!==a);d(t)},children:"Remove"})]},a)),e.jsx("button",{className:"text-blue-800 hover:text-blue-600 font-semibold",onClick:()=>d([...o,{name:"",dosage:"",instructions:""}]),children:"Add More Medicines"})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[e.jsx("button",{onClick:F,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Cancel"}),e.jsx("button",{onClick:L,className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600",children:"Save"})]})]})}),V&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Prescription Details"}),c?e.jsxs("div",{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Prescription Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(c.prescriptionDate).toLocaleDateString()})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Medicines"}),e.jsx("ul",{className:"list-disc list-inside",children:(v=c==null?void 0:c.medicines)==null?void 0:v.map((s,a)=>e.jsxs("li",{className:"text-gray-900",children:[s.name," - ",s.dosage," - ",s.instructions]},a))})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>h(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600",children:"Close"}),e.jsx("button",{onClick:async()=>{try{await x.delete(`${u}/prescription/${c._id}`),b("Prescription deleted successfully","success"),f(null),h(!1)}catch(s){console.error("Error deleting prescription:",s),b("Error deleting prescription","error")}},className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Delete Prescription"})]})]}):e.jsx("p",{className:"text-center text-gray-700",children:"No prescription details available."})]})})]})},ge=()=>e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(se,{})]});export{ge as default};
